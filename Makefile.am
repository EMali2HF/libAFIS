# -*- makefile-automake -*-
#
# Configuration bootstrap, top level makefile
#
# $Id$
#
# Blame: Jordan Hrycaj <jordan@teddy-net.com>

# recommended by libtoolize
ACLOCAL_AMFLAGS = -I m4lib

SUBDIRS       = boot Sources
CLEANFILES    =
BUILT_SOURCES = boot/Makefile

# ---------------------------------------------------------------------------
# Auto-for-build configuration
# ---------------------------------------------------------------------------

help:
	@echo
	@echo "$(MAKE) [target]"
	@echo
	@echo "target: all [dist]clean -- standard targets"
	@echo "      | test            -- run legacy tests"
	@echo

# Build environment (unused yet)
.PHONY: prepare
prepare: $(BUILT_SOURCES)

boot/Makefile:
	$(MAKE) -C boot -f Build Makefile

# ---------------------------------------------------------------------------
# Legacy tests
# ---------------------------------------------------------------------------

test:
	$(MAKE) -C Sources test

# ---------------------------------------------------------------------------
# Auto configuration helper
# ---------------------------------------------------------------------------

.PHONY: libtool
libtool: $(LIBTOOL_DEPS)
	$(SHELL) ./config.status --recheck

.PHONY: autoreconf reconf
autoreconf reconf: libtool
	rm -f $(AUTOGENERATED)
	touch configure.ac
	autoreconf

# ---------------------------------------------------------------------------
# End
# ---------------------------------------------------------------------------
